{"name":"Chef-thumbor-ng","tagline":"Chef Cookbook to Install/Manage Thumbor","body":"thumbor_ng Cookbook\r\n================\r\n\r\n[![Build Status](https://travis-ci.org/vkhatri/chef-thumbor-ng.svg?branch=master)](https://travis-ci.org/vkhatri/chef-thumbor-ng)\r\n\r\n\r\nThis is a [Chef] Cookbook to Install and Configure [Thumbor].\r\n\r\nThis cookbook was heavily inspired from thumbor cookbook maintained by Zanui.\r\n\r\n\r\n## Repository\r\n\r\nhttps://github.com/vkhatri/chef-thumbor-ng\r\n\r\n\r\n## Supported OS\r\n\r\nCurrently cookbook supports only Ubuntu.\r\n\r\nThis cookbook was tested on 12.04 and expected to work on 14.04.\r\n\r\n\r\n## Supported Install Methods\r\n\r\nThis cookbook only supports `pip` based installation. As mentioned in [Thumbor] wiki, new release is\r\nalways available via `pip`. Other install methods like `source code` or `package` are not\r\nincorporated in this cookbook.\r\n\r\n## Recipes\r\n\r\n- `thumbor_ng::default`    - default cookbook run_list recipe\r\n\r\n- `thumbor_ng::install`  \t- install packages required for thumbor\r\n\r\n- `thumbor_ng::user`   \t\t- setup user for thumbor service\r\n\r\n- `thumbor_ng::config`\t\t  - setup and mange thumbor configuration\r\n\r\n- `thumbor_ng::monit`\t\t  - setup monit checks for nginx/thumbor using cookbook `monit-ng`\r\n\r\n- `thumbor_ng::nginx`\t\t  - setup and manage frontend proxy nginx for thumbor using cookbook `nginx`\r\n\r\n- `thumbor_ng::redis`\t\t  - setup redis for thumbor using cookbook `redisio`\r\n\r\n- <del> `thumbor_ng::haproxy`\t\t- setup and mange fronend proxy haproxy for thumbor, not completed yet </del>\r\n\r\n- <del> `thumbor_ng::varnish`\t\t- setup and mange fronend proxy varnish for thumbor, not completed yet </del>\r\n\r\n> For run_list use `recipe[thumbor_ng::default]` or `recipe[thumbor_ng]`\r\n\r\n\r\n## Cookbook Advanced Attributes\r\n\r\n * `default['thumbor_ng']['proxy']` (default: `nginx`): thumbor service front end proxy, currently only supports nginx\r\n\r\n * `default['thumbor_ng']['storage']['type']` (default: `file`): thumbor storage type\r\n\r\n * `default['thumbor_ng']['init_style']` (default: `upstart`): thumbor service manager, options: initd upstart\r\n\r\n * `default['thumbor_ng']['notify_restart']` (default: `true`): notify thumbor service on a resource change\r\n\r\n * `default['thumbor_ng']['setup_redis']` (default: `true`): whether to setup redis instance using cookbook - `redisio`\r\n\r\n * `default['thumbor_ng']['setup_user']` (default: `true`): setup user for thumbor service\r\n\r\n * `default['thumbor_ng']['monit']['enable']` (default: `false`): enables monit checks for nginx and thumbor service using cookbook - `monit-ng`\r\n\r\n * <del> `default['thumbor_ng']['queue']['type']` (default: `redis`): thumbor detector queue type, option complete setup not tested yet </del>\r\n\r\n\r\n\r\n## Cookbook Core Attributes\r\n\r\n * `default['thumbor_ng']['version']` (default: `4.5.4`): [Thumbor] release version\r\n\r\n * `default['thumbor_ng']['processes']` (default: `node['cpu']['total']`): # of thumbor processes, default utilizes all CPU cores\r\n\r\n * `default['thumbor_ng']['base_port']` (default: `9000`): thumbor service base port to spawn multiple processes\r\n\r\n * `default['thumbor_ng']['key']` (default: ``): thumbor secret key file content\r\n\r\n * <del> `default['thumbor_ng']['log_dir']` (default: `/var/log/thumbor`): thumbor logs directory, not yet tested </del>\r\n\r\n * `default['thumbor_ng']['service_name']` (default: `thumbor`): thumbor service name\r\n\r\n * `default['thumbor_ng']['install_method']` (default: `pip`): thumbor install method\r\n\r\n * `default['thumbor_ng']['listen_address']` (default: `127.0.0.1`): inet for thumbor service, change it with caution\r\n\r\n * `default['thumbor_ng']['binary']` (default: `/usr/local/bin/thumbor`): thumbor binary location for thumbor service\r\n\r\n * `default['thumbor_ng']['upstart_respawn']` (default: `true`): respawn service if goes down\r\n\r\n * `default['thumbor_ng']['conf_file']` (default: `/etc/thumbor.conf`): thumbor configuration file\r\n\r\n * `default['thumbor_ng']['key_file']` (default: `/etc/thumbor.key`): thumbor key file\r\n\r\n * `default['thumbor_ng']['group']` (default: `thumbor`): thumbor service group\r\n\r\n * `default['thumbor_ng']['user']` (default: `thumbor`): thumbor service user\r\n\r\n * `default['thumbor_ng']['user_home']` (default: `nil`): thumbor service user home directory\r\n\r\n\r\n## Cookbook apt Repositories Attributes\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['uri']` (default: `http://ppa.launchpad.net/thumbor/ppa/ubuntu`): repo uri\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['distribution']` (default: `node['lsb']['codename']`): repo distribution\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['keyserver']` (default: `keyserver.ubuntu.com`): repo keyserver\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['components']` (default: `[main]`): repo components\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['key']` (default: `68DFB11CCBEC8F27`): repo key\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['deb_src']` (default: `false`): whether to fetch source\r\n\r\n * `default['thumbor_ng']['apt']['thumbor']['action']` (default: `add`): apt_repository resource action\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['uri']` (default: `http://archive.ubuntu.com/ubuntu`): repo uri\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['distribution']` (default: `node['lsb']['codename']`): repo distribution\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['keyserver']` (default: `keyserver.ubuntu.com`): repo keyserver\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['components']` (default: `[main multiverse restricted universe]`): repo components\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['key']` (default: `40976EAF437D05B5`): repo key\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['deb_src']` (default: `false`): whether to fetch source\r\n\r\n * `default['thumbor_ng']['apt']['multiverse']['action']` (default: `add`): apt_repository resource action\r\n\r\n\r\n## Cookbook thumbor Service Ulimit Attributes\r\n\r\n * `default['thumbor_ng']['limits']['memlock']` (default: `unlimited`): thumbor service memory limit\r\n\r\n * `default['thumbor_ng']['limits']['nofile']` (default: `48000`): thumbor service file limit\r\n\r\n * `default['thumbor_ng']['limits']['nproc']` (default: `unlimited`): thumbor service proc limit\r\n\r\n\r\n## Cookbook nginx Attributes\r\n\r\n * `default['nginx']['default_site_enabled']` (default: `false`): disable default nginx site\r\n\r\n * `default['nginx']['worker_connections']` (default: `4096`): nginx worker connections\r\n\r\n * `default['thumbor_ng']['nginx']['port']` (default: `80`): nginx port\r\n\r\n * `default['thumbor_ng']['nginx']['server_name']` (default: `node['fqdn']`): nginx thumbor vhost server name\r\n\r\n * `default['thumbor_ng']['nginx']['client_max_body_size']` (default: `10M`): nginx thumbor vhost client max body\r\n\r\n * `default['thumbor_ng']['nginx']['proxy_read_timeout']` (default: `300`): nginx thumbor vhost proxy read timeout\r\n\r\n * `default['thumbor_ng']['nginx']['proxy_cache']['enabled']` (default: `false`): enable proxy cache in nginx thumbor vhost\r\n\r\n * `default['thumbor_ng']['nginx']['proxy_cache']['path']` (default: `/var/www/thumbor_cache`): nginx thumbor vhost proxy cache location\r\n\r\n * `default['thumbor_ng']['nginx']['proxy_cache']['key_zone']` (default: `thumbor_cache`): nginx thumbor vhost proxy cache key zone\r\n\r\n * `default['thumbor_ng']['nginx']['vhost']['cookbook']` (default: `thumbor_ng`): nginx thumbor vhost template cookbook name\r\n\r\n * `default['thumbor_ng']['nginx']['vhost']['template']` (default: `nginx.thumbor.vhost.erb`): nginx thumbor vhost template name\r\n\r\n * `default['thumbor_ng']['nginx']['vhost']['variables']` (default: `{}`): nginx thumbor vhost template variables\r\n\r\n        For more nginx attributes, check out nginx cookbook\r\n\r\n\r\n## Cookbook redis Attributes\r\n\r\nRedis is setup using cookbook `redisio`.\r\n\r\n        For more nginx attributes, check out redisio cookbook\r\n\r\n\r\n## Cookbook monit Attributes\r\n\r\nMonit checks for `thumbor` and `nginx` (or `haproxy` or `varnish`).\r\n\r\n        For more monit checks attributes & configuration, check out monit-ng cookbook\r\n\r\n\r\n## Cookbook thumbor Default Configuration Attributes\r\n\r\n * `default['thumbor_ng']['options']['FILE_STORAGE_ROOT_PATH']` (default: `/var/lib/thumbor/file_storage`): thumbor file storage location\r\n\r\n * `default['thumbor_ng']['options']['RESULT_STORAGE_FILE_STORAGE_ROOT_PATH']` (default: `/var/lib/thumbor/result_storage`): thumbor result file storage location\r\n\r\n\r\n## Cookbook Dependencies\r\n\r\n* `apt`\r\n* `python`\r\n* `nginx`\r\n* `ulimit`\r\n* `monit-ng`\r\n* `redisio`\r\n\r\n\r\n## TODO\r\n\r\n* Add support for RHEL platform family\r\n* Add HAProxy frontend proxy\r\n* Add Varnish frontend proxy\r\n\r\n\r\n## Contributing\r\n\r\n1. Fork the repository on Github\r\n2. Create a named feature branch (like `add_component_x`)\r\n3. Write your change\r\n4. Write tests for your change (if applicable)\r\n5. Run the tests (`rake`), ensuring they all pass\r\n6. Write new resource/attribute description to `README.md`\r\n7. Write description about changes to PR\r\n8. Submit a Pull Request using Github\r\n\r\n\r\n## Copyright & License\r\n\r\nAuthors:: Virender Khatri and [Contributors]\r\n\r\n<pre>\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n</pre>\r\n\r\n[Thumbor]:https://github.com/thumbor/thumbor\r\n[Chef]: https://www.getchef.com/chef/\r\n[Contributors]: https://github.com/vkhatri/chef-thumbor-ng/graphs/contributors\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}